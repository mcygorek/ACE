<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="documentation.tex"> 
<link rel="stylesheet" type="text/css" href="documentation.css"> 
</head><body 
>
<div class="center" 
>
<!--l. 7--><p class="noindent" >
<!--l. 8--><p class="noindent" ><span 
class="ecbx-1728">ACE Documentation</span><br />
<span 
class="ecti-1440">Moritz Cygorek</span></div>
  <h3 class="sectionHead"><span class="titlemark">1 </span> <a 
 id="x1-10001"></a>Introduction</h3>
<!--l. 12--><p class="noindent" >This document describes how to use the C++ code ACE for the solution of open quantum
systems using the <span 
class="ecti-1095">automated compression of environments </span>(ACE) method. The article
explaining the method can be found <a 
href="https://arxiv.org/abs/2101.01653" >here</a>.
<!--l. 18--><p class="indent" >  ACE enables numerically exact simulations of the dynamics of an open quantum systems
described by the quantum Liouville equation
  <table 
class="equation"><tr><td><a 
 id="x1-1001r1"></a>
  <center class="math-display" >
<img 
src="documentation0x.png" alt="&#x2202;       i
&#x2202;t&#x03C1; = -&#x210F;-[H, &#x03C1;]+ Lnonh.[&#x03C1;]
" class="math-display" ></center></td><td class="equation-label">(1)</td></tr></table>
<!--l. 23--><p class="nopar" >
where the microscopic Hamiltonian
  <table 
class="equation"><tr><td><a 
 id="x1-1002r2"></a>
  <center class="math-display" >
<img 
src="documentation1x.png" alt="                      NE
H  = H  +  H  = H   + &#x2211;  Hk ,
       S    E     S        E
                      k=1
" class="math-display" ></center></td><td class="equation-label">(2)</td></tr></table>
                                                                                
                                                                                
<!--l. 28--><p class="nopar" >
is split up into system <span 
class="cmmi-10x-x-109">H</span><sub><span 
class="cmmi-8">S</span></sub> and environment Hamiltonians <span 
class="cmmi-10x-x-109">H</span><sub><span 
class="cmmi-8">E</span></sub>. The environment Hamiltonian
<span 
class="cmmi-10x-x-109">H</span><sub><span 
class="cmmi-8">E</span></sub>, which we define as also including the system-environment coupling, is assumed to be
separable into <span 
class="cmmi-10x-x-109">N</span><sub><span 
class="cmmi-8">E</span></sub> independent modes <span 
class="cmmi-10x-x-109">k</span>. <span 
class="cmsy-10x-x-109"><img 
src="cmsy10-4c.png" alt="L" class="10-109x-x-4c" /></span><sub><span 
class="cmmi-8">nonh.</span></sub><span 
class="cmr-10x-x-109">[</span><span 
class="cmmi-10x-x-109">&#x03C1;</span><span 
class="cmr-10x-x-109">] </span>denotes non-Hamiltonian contributions
to the dynamics such as Lindblad terms affecting the system, the environment, or
both.
<!--l. 41--><p class="indent" >  The goal is to obtain the reduced system density matrix discretized on a time grid
<span 
class="cmmi-10x-x-109">t</span><sub><span 
class="cmmi-8">l</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">t</span><sub><span 
class="cmmi-8">a</span></sub> <span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">l</span><span 
class="cmr-10x-x-109">&#x0394;</span><span 
class="cmmi-10x-x-109">t </span>up to a given final time <span 
class="cmmi-10x-x-109">t</span><sub><span 
class="cmmi-8">n</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">t</span><sub><span 
class="cmmi-8">a</span></sub> <span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">n</span><span 
class="cmr-10x-x-109">&#x0394;</span><span 
class="cmmi-10x-x-109">t </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">t</span><sub><span 
class="cmmi-8">e</span></sub>. This can be done using the path
integral expression
  <table 
class="equation"><tr><td><a 
 id="x1-1003r3"></a>
  <center class="math-display" >
<img 
src="documentation2x.png" alt="        &#x2211;                   &#x220F;n
&#x03C1; &#x03B1;n =        I(&#x03B1;n&#x02DC;&#x03B1;n)...(&#x03B1;1&#x02DC;&#x03B1;1)(   M &#x03B1;&#x02DC;l&#x03B1;l- 1)&#x03C1;&#x03B1; ,
      &#x03B1;n-1...&#x03B1;0              l=1           0
       &#x02DC;&#x03B1;n...&#x02DC;&#x03B1;1
" class="math-display" ></center></td><td class="equation-label">(3)</td></tr></table>
<!--l. 53--><p class="nopar" >
where <span 
class="cmmi-10x-x-109">&#x03C1;</span><sub><span 
class="cmmi-8">&#x03B1;</span><sub><span 
class="cmmi-6">l</span></sub></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">&#x03C1;</span><sub><span 
class="cmmi-8">&#x03BD;</span><sub><span 
class="cmmi-6">l</span></sub><span 
class="cmmi-8">&#x03BC;</span><sub><span 
class="cmmi-6">l</span></sub></sub> is the reduced system density matrix at time step <span 
class="cmmi-10x-x-109">l</span>, <span 
class="cmsy-10x-x-109"><img 
src="cmsy10-4d.png" alt="M" class="10-109x-x-4d" /> </span>describes the free
time evolution of the system without the environment, and <span 
class="cmsy-10x-x-109"><img 
src="cmsy10-49.png" alt="I" class="10-109x-x-49" /> </span>is the <span 
class="ecti-1095">process tensor </span>(PT)
accounting for the effects of the environment. To keep the notation compact, we combine two
Hilbert space indices on the system density matrix <span 
class="cmmi-10x-x-109">&#x03BD;</span><sub><span 
class="cmmi-8">l</span></sub> and <span 
class="cmmi-10x-x-109">&#x03BC;</span><sub><span 
class="cmmi-8">l</span></sub> into a single Liouville space index
<span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">l</span></sub> <span 
class="cmr-10x-x-109">= (</span><span 
class="cmmi-10x-x-109">&#x03BD;</span><sub><span 
class="cmmi-8">l</span></sub><span 
class="cmmi-10x-x-109">,&#x03BC;</span><sub><span 
class="cmmi-8">l</span></sub><span 
class="cmr-10x-x-109">)</span>. The PT can always expressed in the form of a matrix product operator
(MPO)
  <table 
class="equation"><tr><td><a 
 id="x1-1004r4"></a>
  <center class="math-display" >
<img 
src="documentation3x.png" alt="  (&#x03B1;n,&#x02DC;&#x03B1;n)(&#x03B1;n-1,&#x03B1;&#x02DC;n-1)...(&#x03B1;1,&#x02DC;&#x03B1;1)    &#x2211;      (&#x03B1;n,&#x02DC;&#x03B1;n)  (&#x03B1;n-1,&#x03B1;&#x02DC;n-1)     (&#x03B1;1,&#x02DC;&#x03B1;1)
I                       =        Q 1dn-1 Q dn-1dn-2  ...Q d11   .
                          dn-1...d1
" class="math-display" ></center></td><td class="equation-label">(4)</td></tr></table>
                                                                                
                                                                                
<!--l. 73--><p class="nopar" >
In the explicit derivation of the matrices <span 
class="cmsy-10x-x-109"><img 
src="cmsy10-51.png" alt="Q" class="10-109x-x-51" /></span>, the inner indices <span 
class="cmmi-10x-x-109">d</span><sub><span 
class="cmmi-8">l</span></sub> correspond to a complete basis
of the Liouville space of the full environment, which can be extremely large. However, the inner
dimensions of MPOs can be systemaically reduced using established compression
techniques. Here, we use a compression method based on singular value decomposition
(SVD), where singular values below a predefined threshold <span 
class="cmmi-10x-x-109">&#x03F5; </span>are disregarded. The time
discretization <span 
class="cmr-10x-x-109">&#x0394;</span><span 
class="cmmi-10x-x-109">t </span>and the compression threshold <span 
class="cmmi-10x-x-109">&#x03F5; </span>are the main convergence parameters of
ACE.
<!--l. 84--><p class="indent" >  The working principle of ACE is to construct the PT in compressed MPO form by
calculating the PTs for the individual environment modes <span 
class="cmmi-10x-x-109">k </span>and then combining
them one by one. After each combination step, the PT MPO is compressed using
SVDs to reduce the inner dimensions to a manageable size at all times. Once the
compressed PT is calculated, the reduced system density matrix for a given system
Hamiltonian and system initial state can be obtained by contracting a simple tensor
network.
<!--l. 94--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">2 </span> <a 
 id="x1-20002"></a>Code, Compilation, Dependencies, and Design Choices</h3>
<!--l. 95--><p class="noindent" >The code is written in C++ to combine low-level optimization (memory storage,
access to LAPACK routines) with high-level abstraction. It has been most thoroughly
tested on the Linux operating system but it also compiles and runs on Mac and
Windows.
<!--l. 100--><p class="indent" >  We have tried to keep the dependencies on other codes minimal. However, the <a 
href="http://eigen.tuxfamily.org" >Eigen</a> library
is very handy and provides useful and efficient routines, e.g., for matrix exponentials, so we
make use of it at multiple places in the code. This dependency is harmless, as Eigen is
&#8220;header only&#8221;, i.e. it does not require installation beyond downloading the header
files.
<!--l. 107--><p class="indent" >  The numerically most demanding part of ACE is the calculation of SVDs, for which
LAPACK routines are available (optional), e.g., within the <a 
href="https://software.intel.com/content/www/us/en/develop/tools/math-kernel-library.html" >Intel MKL</a>. These routines provide
some degree of parallelization and, according to a few tests, reduce the computation time
typically by a factor of 2-5. Note, however, using LAPACK routines, we have encountered
instabilities for very small threshold values (<span 
class="cmmi-10x-x-109">&#x03F5; </span><span 
class="cmsy-10x-x-109">&#x226A; </span><span 
class="cmr-10x-x-109">10</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">12</span></sup>). Whether or not to use these routines
is decided by the user at the compilation stage.
<!--l. 118--><p class="indent" >  On Linux or Mac, Makefiles can be used for the compilation and some tuning can be done by
command line arguments. For example, for the compiler to find the Eigen library, please set the
variable <span 
class="ectt-1095">EIGEN_HOME </span>manually (only required for the compilation step) in such a
way that the file <span 
class="ectt-1095">$EIGEN_HOME/Eigen/Eigen </span>exists. If the variable is not set, the
script will try the most common directory <span 
class="ectt-1095">/usr/include/eigen3/</span>, which is, e.g., the
place where Eigen is installed on Ubuntu Linux by the command <span 
class="ectt-1095">sudo apt install</span>
<span 
class="ectt-1095">libeigen3-dev</span>.
<!--l. 127--><p class="indent" >  If the MKL is installed on your system, the <span 
class="ectt-1095">MKLROOT </span>environment variable should be set to
                                                                                
                                                                                
the correct directory. If this variable is set at the compilation stage, ACE will use the
corresponding SVD routines.
<!--l. 133--><p class="indent" >  To compile the code, set the corresponding environment variables, go into the main directory
of ACE and type in the console
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-1">
&#x003E;&#x00A0;make
</div>
<!--l. 138--><p class="nopar" > This compiles the code and moves the binaries into the <span 
class="ectt-1095">bin/ </span>subdirectory. For easy access
later on, we suggest to add this directory to your Linux environment via the <span 
class="ectt-1095">PATH </span>variable. For
example, add the follwing line to your <span 
class="cmsy-10x-x-109">~</span><span 
class="ectt-1095">/.bashrc </span>file
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-2">
PATH=/.../ACE/bin/:$PATH
</div>
<!--l. 145--><p class="nopar" > where <span 
class="cmmi-10x-x-109">&#x2026;</span><span style="margin-left:0.3em" class="thinspace"></span> is to be replaced by the correct absolute path to the ACE directory. Log out
and log in again to activate the changes. Then, go to a temporary directory and
run
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-3">
&#x003E;&#x00A0;ACE
</div>
<!--l. 151--><p class="nopar" > This should generate a file <span 
class="ectt-1095">ACE.out </span>whose first lines are
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-4">
0&#x00A0;0&#x00A0;0&#x00A0;1&#x00A0;0&#x00A0;0&#x00A0;0
&#x00A0;<br />0.01&#x00A0;0&#x00A0;0&#x00A0;1&#x00A0;0&#x00A0;0&#x00A0;0
&#x00A0;<br />0.02&#x00A0;0&#x00A0;0&#x00A0;1&#x00A0;0&#x00A0;0&#x00A0;0
&#x00A0;<br />0.03&#x00A0;0&#x00A0;0&#x00A0;1&#x00A0;0&#x00A0;0&#x00A0;0
&#x00A0;<br />0.04&#x00A0;0&#x00A0;0&#x00A0;1&#x00A0;0&#x00A0;0&#x00A0;0
&#x00A0;<br />...
</div>
<!--l. 160--><p class="nopar" > Congratulations! You have just executed your first (rather boring) simulation using
ACE.
<!--l. 165--><p class="indent" >  Compilation on Windows has been tested using the GCC compiler in <a 
href="http://mingw-w64.org/doku.php" >MinGW</a>. We provide a
compile script with <span 
class="ectt-1095">compile.bat </span>in the ACE directory. Please take a look and modify the path
to the Eigen library according to your system specifics.
<!--l. 170--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">3 </span> <a 
 id="x1-30003"></a>General usage</h3>
<!--l. 171--><p class="noindent" >ACE is designed to be fully controllable by command line parameters, so the source code does
not have to be modified and no prior knowledge in C++ required. Alternatively, the command
line parameters can be composed into a driver file, which can then be passed to
the code via the <span 
class="ectt-1095">-driver </span>command line option or simply as the first command line
argument.
<!--l. 179--><p class="indent" >  Initial states, Hamiltonians, Lindblad terms, and observables for the system as well as for
individual environment modes can be specified directly and quite generally, but additional sets
of parameters are implemented that allow a more convenient control of certain typical types of
environments.
<!--l. 185--><p class="indent" >  Generally, times, energies, and temperatures are expected to be provided in units of ps, meV,
and K, but it&#8217;s easy to work with dimensionless quantities by rescaling the total Hamiltonian
as well as the time, which are related by <img 
src="documentation4x.png" alt="--&#x2202;--
&#x2202;(t&#x2215;&#x03BB;)"  class="frac" align="middle"><span 
class="cmsy-10x-x-109">|</span><span 
class="cmmi-10x-x-109">&#x03C8;</span><span 
class="cmsy-10x-x-109">&#x27E9; </span><span 
class="cmr-10x-x-109">= (</span><span 
class="cmmi-10x-x-109">&#x03BB;H</span><span 
class="cmr-10x-x-109">)</span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmmi-10x-x-109">&#x03C8;</span><span 
class="cmsy-10x-x-109">&#x27E9;</span>.
<!--l. 191--><p class="indent" >  Many objects, such as initial states, Hamiltonians, or observables are complex matrices. The
ACE code has a rudimentary parser that interprets &#8220;matrix valued expressions&#8221; which are
identified by curly braces. The bra-ket notation (or rather ket-bra expressions) is supported.
Note that to generate the corresponding matrices, the Hilbert space dimension has to specified.
Concretely, <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">{|i&#x003E;&#x003C;j|_d}</span></span></span> is interpreted as the operator that describes a transition
from state <span 
class="cmmi-10x-x-109">j </span>to state <span 
class="cmmi-10x-x-109">i </span>in a <span 
class="cmmi-10x-x-109">d</span>-dimensional space, where we use the convention that
<span 
class="cmmi-10x-x-109">i,j </span><span 
class="cmr-10x-x-109">= 0</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmr-10x-x-109">1</span><span 
class="cmmi-10x-x-109">,</span><span 
class="cmmi-10x-x-109">&#x2026;</span><span 
class="cmmi-10x-x-109">,d </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmr-10x-x-109">1</span>.
<!--l. 200--><p class="indent" >  For example, the Pauli matrix <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmmi-8">y</span></sub> can be expressed as <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">{</span><span 
class="ectt-1095">&#x00A0;-i*|1&#x003E;&#x003C;0|_2</span><span 
class="ectt-1095">&#x00A0;+</span><span 
class="ectt-1095">&#x00A0;i*|0&#x003E;&#x003C;1|_2}</span></span></span> or
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">{i*(</span><span 
class="ectt-1095">&#x00A0;-|1&#x003E;&#x003C;0|_2</span><span 
class="ectt-1095">&#x00A0;+</span><span 
class="ectt-1095">&#x00A0;|0&#x003E;&#x003C;1|_2</span><span 
class="ectt-1095">&#x00A0;)}</span></span></span>. Some operators are also known by name, such as
the Pauli matrices <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">sigma_x</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">sigma_y</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">sigma_z</span></span></span>, or the identity matrix <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Id_d</span></span></span>, where
<span 
class="ectt-1095">d </span>has the be replaced by the respective dimension of the Hilbert space. Also
                                                                                
                                                                                
supported are bosonic creation, annihilation, and number operators <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">bdagger_d</span></span></span>,
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">b_d</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">n_d</span></span></span>, and direct products of matrices can be defined using <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">otimes</span></span></span> as in
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">{</span><span 
class="ectt-1095">&#x00A0;hbar*1*(|0&#x003E;&#x003C;1|_2</span><span 
class="ectt-1095">&#x00A0;otimes</span><span 
class="ectt-1095">&#x00A0;bdagger_4</span><span 
class="ectt-1095">&#x00A0;+</span><span 
class="ectt-1095">&#x00A0;|1&#x003E;&#x003C;0|_2</span><span 
class="ectt-1095">&#x00A0;otimes</span><span 
class="ectt-1095">&#x00A0;b_4)}</span></span></span>, which describes
the Jaynes-Cummings interaction with coupling strength 1 between a TLS and a
bosonic mode containing up to (4-1)=3 photons. Furthermore, some constants like
<span 
class="ectt-1095">hbar </span>(in units of meV ps) or <span 
class="ectt-1095">pi </span>can be used as well as the square root function
<span 
class="ectt-1095">sqrt(...)</span>.
<!--l. 217--><p class="indent" >  Note that when specified directly on the command line, quotes are required around the curly
braces to avoid interpretation of the curly braces by the <span 
class="ectt-1095">bash </span>shell. No quotes are used in
parameter files.
<!--l. 222--><p class="indent" >  Initial system states are given in terms of the initial system density matrix, which is of
matrix valued expression form specified by the parameter <span 
class="ectt-1095">initial</span>. To extract relevant
information, the values of a set of observables for each time step are written into an output file
(file name specified by parameter <span 
class="ectt-1095">outfile</span>, default value: &#8220;ACE.out&#8221;). These observables
are desribed by operators on the system Hilbert space, e.g., <span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="cmmi-10x-x-109">Â</span><span 
class="cmsy-10x-x-109">&#x27E9; </span><span 
class="cmr-10x-x-109">=</span> Tr<sub><span 
class="cmmi-8">S</span></sub><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">Â</span><span 
class="cmmi-10x-x-109">&#x03C1;</span><sub><span 
class="cmmi-8">S</span></sub><span 
class="cmr-10x-x-109">)</span>, where
<span 
class="cmmi-10x-x-109">&#x03C1;</span><sub><span 
class="cmmi-8">S</span></sub> is the reduced system density matrix. The operators <span 
class="cmmi-10x-x-109">Â</span> have to be provided as
matrix valued expressions to the parameter <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">add_Output</span></span></span>. This parameter can occur
multiple times, with every occurrence adding another two columns to the output file,
corresponding to real and imaginary parts of the respective operator average. If no parameter
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">add_Output</span></span></span> is specified, default values are used which are equivalent to the command line
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">-add_Output</span><span 
class="ectt-1095">&#x00A0;"{|1&#x003E;&#x003C;1|_2}"</span><span 
class="ectt-1095">&#x00A0;-add_Output</span><span 
class="ectt-1095">&#x00A0;"{|0&#x003E;&#x003C;0|_2}"</span><span 
class="ectt-1095">&#x00A0;-add_Output</span><span 
class="ectt-1095">&#x00A0;"{|0&#x003E;&#x003C;1|_2}"</span></span></span>. This
implies that it is absolutely necessary to specify <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">add_Output</span></span></span> explicitly when dealing with a
system with more than two levels.
<!--l. 241--><p class="indent" >  It is generally advised to specify the three parts&#8212;initial density matrix, system Hamiltonian,
and output observables&#8212;in every parameter file. Of course, the dimensions have to be the
same of all three types of matrices.
<!--l. 247--><p class="indent" >  A few hands-on examples demonstrating the usage in concrete applications are given in the
next sections.
<!--l. 250--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">4 </span> <a 
 id="x1-40004"></a>Free system dynamics</h3>
<!--l. 252--><p class="noindent" >In this section, we focus on the usage of the ACE code on examples without explicit
environment parts, i.e., closed few-level systems or Lindblad master equations.
<!--l. 256--><p class="indent" >  We begin with some of the most important parameters: The starting time, the final time,
and the time step width can be specified by the command line options <span 
class="ectt-1095">-ta</span>, <span 
class="ectt-1095">-te</span>, and <span 
class="ectt-1095">-dt</span>,
respectively, which have the default values 0, 10, and 0.01. You will find the corresponding time
grid in the first column of output file <span 
class="ectt-1095">ACE.out</span>, whose name may be changed via the option
<span 
class="ectt-1095">-outfile</span>. By default, there will be no environment, the system is a two-level system (TLS)
initially in its ground state, and the system Hamiltonian is <span 
class="cmmi-10x-x-109">H</span><sub><span 
class="cmmi-8">S</span></sub> <span 
class="cmr-10x-x-109">= 0</span>. For TLSs, if not
specified otherwise, the second and third columns in the output file will be the real and
imaginary part of the diagonal element of the system density matrix corresponding to the
                                                                                
                                                                                
exited state. If no parameters are specified explicitly, these columns should remain
0.
<!--l. 269--><p class="indent" >  As a first example, run
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-5">
&#x003E;&#x00A0;ACE&#x00A0;-dt&#x00A0;0.001&#x00A0;-te&#x00A0;20&#x00A0;-add_Hamiltonian&#x00A0;"{hbar/2*(|1&#x003E;&#x003C;0|_2+|0&#x003E;&#x003C;1|_2)}"&#x00A0;-outfile&#x00A0;ACE1.out
</div>
<!--l. 272--><p class="nopar" > This will generate an output file <span 
class="ectt-1095">ACE1.out</span>, which contains the dynamics of a constantly
driven TLS from 0 to 20 ps with time steps of 0.001 ps. The driving is described
by the Hamiltonian <span 
class="cmmi-10x-x-109">H</span><sub><span 
class="cmmi-8">S</span></sub> <span 
class="cmr-10x-x-109">= (</span><span 
class="msbm-10x-x-109">&#x210F;</span><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">2)(</span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmmi-10x-x-109">X</span><span 
class="cmsy-10x-x-109">&#x27E9;&#x27E8;</span><span 
class="cmmi-10x-x-109">G</span><span 
class="cmsy-10x-x-109">| </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmmi-10x-x-109">G</span><span 
class="cmsy-10x-x-109">&#x27E9;&#x27E8;</span><span 
class="cmmi-10x-x-109">X</span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">) </span>(note: hbar is given in units of
meVps).
<!--l. 279--><p class="indent" >  Plotting the second column of <span 
class="ectt-1095">ACE1.out </span>(in gnuplot: <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">plot</span><span 
class="ectt-1095">&#x00A0;"ACE1.out"</span><span 
class="ectt-1095">&#x00A0;using</span><span 
class="ectt-1095">&#x00A0;1:2</span><span 
class="ectt-1095">&#x00A0;with</span><span 
class="ectt-1095">&#x00A0;lines</span></span></span>)
reveals clear Rabi oscillations of the excited state occupations:
<!--l. 284--><p class="indent" >  <img 
src="figs/example1.png" alt="PIC"  
width="569" height="279" >
<!--l. 289--><p class="indent" >  The same result can be obtained creating and editing the file <span 
class="ectt-1095">driver1.param</span>:
<!--l. 293--><p class="noindent" >______________________________________
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-6">
dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.001
&#x00A0;<br />te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20
&#x00A0;<br />
&#x00A0;<br />add_Hamiltonian&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{hbar/2*(|1&#x003E;&#x003C;0|_2+|0&#x003E;&#x003C;1|_2)}
&#x00A0;<br />
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ACE1.out
</div>
<!--l. 302--><p class="nopar" >______________________________________
<!--l. 305--><p class="indent" >  and running
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-7">
&#x003E;&#x00A0;ACE&#x00A0;-driver&#x00A0;driver1.param
</div>
<!--l. 308--><p class="nopar" > or simply
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-8">
&#x003E;&#x00A0;ACE&#x00A0;driver1.param
</div>
<!--l. 312--><p class="nopar" > I.e., the first parameter is interpreted as a driver file.
<!--l. 315--><p class="indent" >  A more complicated scenario can be described by the following driver file (<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">driver2.param</span></span></span>),
where an initially excited TLS, optionally subject to radiative decay described by a Lindblad
term, is driven by a Gaussian laser pulse:
<!--l. 320--><p class="noindent" >______________________________________
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-9">
dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.01
&#x00A0;<br />te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20
&#x00A0;<br />
&#x00A0;<br />initial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|1&#x003E;&#x003C;1|_2}
&#x00A0;<br />
&#x00A0;<br />#add_Lindblad&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.5&#x00A0;&#x00A0;{|0&#x003E;&#x003C;1|_2}
&#x00A0;<br />add_Pulse&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Gauss&#x00A0;&#x00A0;10&#x00A0;1&#x00A0;{1.*pi}&#x00A0;0&#x00A0;&#x00A0;{|1&#x003E;&#x003C;0|_2}
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ACE2.out
</div>
<!--l. 331--><p class="nopar" >______________________________________
<!--l. 334--><p class="indent" >  This produces the following dynamics:
<!--l. 336--><p class="indent" >  <img 
src="figs/example2.png" alt="PIC"  
width="569" height="279" >
<!--l. 338--><p class="indent" >  where the two curves are results of calculations where the Lindblad term is either turned off
or on. The # symbol in a driver file indicates a comment, i.e. anything after it is ignored. The
parameters of <span 
class="ectt-1095">add_Lindblad </span>are the rate <span 
class="cmmi-10x-x-109">&#x03B3; </span>and the operator <span 
class="cmmi-10x-x-109">A </span>for the Lindblad
term
  <table 
class="equation"><tr><td><a 
 id="x1-4001r5"></a>
  <center class="math-display" >
<img 
src="documentation5x.png" alt="                 &#8224;   1  &#8224;        &#8224;
&#x03B3;L [A ](&#x03C1;) = &#x03B3;[A&#x03C1;A  -  2(A A&#x03C1; + &#x03C1;A  A)].
" class="math-display" ></center></td><td class="equation-label">(5)</td></tr></table>
<!--l. 346--><p class="nopar" >
<!--l. 348--><p class="indent" >  The parameters of <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">add_Pulse</span><span 
class="ectt-1095">&#x00A0;Gauss</span></span></span> are the pulse center (here: <span 
class="cmmi-10x-x-109">t</span><sub><span 
class="cmmi-8">c</span></sub> <span 
class="cmr-10x-x-109">= 10 </span>ps), the pulse
duration (<span 
class="cmmi-10x-x-109">&#x03C4;</span><sub><span 
class="cmmi-8">FWHM</span></sub> <span 
class="cmr-10x-x-109">= 1 </span>ps), the pulse area (<span 
class="cmmi-10x-x-109">A </span><span 
class="cmr-10x-x-109">= 1</span><span 
class="cmmi-10x-x-109">&#x03C0;</span>), the detuning (<span 
class="cmmi-10x-x-109">&#x03B4; </span><span 
class="cmr-10x-x-109">= 0 </span>meV), and the
operator (<img 
src="documentation6x.png" alt="d&#x02C6;"  class="circ" ><span 
class="cmr-10x-x-109">= </span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">1</span><span 
class="cmsy-10x-x-109">&#x27E9;&#x27E8;</span><span 
class="cmr-10x-x-109">0</span><span 
class="cmsy-10x-x-109">|</span>) describing the light-matter coupling, which enter the driving
Hamiltonian
  <table 
class="equation"><tr><td><a 
 id="x1-4002r6"></a>
                                                                                
                                                                                
  <center class="math-display" >
<img 
src="documentation7x.png" alt="                                          1 (t-tc)2                      &#x2218; ------
HD  = &#x210F;(f(t)&#x02C6;d+ f*(t)&#x02C6;d&#8224;) with f(t) = &#x221A;-A&#x03C0;-e-2 -&#x03C3;2--e-i(&#x03B4;&#x2215;&#x210F;)t,  &#x03C3; = &#x03C4;FW HM &#x2215;  8 ln(2).
      2                             2&#x03C0;&#x03C3;
" class="math-display" ></center></td><td class="equation-label">(6)</td></tr></table>
<!--l. 359--><p class="nopar" >
<!--l. 362--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">5 </span> <a 
 id="x1-50005"></a>Including environments</h3>
<!--l. 363--><p class="noindent" >In the following subsections, we demonstrate how environment can be included. First of all,
note that as we include multiple environment modes, the total environment Liouville space
becomes prohibitively large very fast and needs to be compressed to remain tractable, which is
the core of the ACE algorithm. To enable compression, one has to specify a criterion. Most
commonly, we use sweeps of singular value decompositions (SVDs) and only keep the
subspaces related to singular values larger than a threshold <span 
class="cmmi-10x-x-109">&#x03F5;&#x03C3;</span><sub><span 
class="cmr-8">0</span></sub>, where <span 
class="cmmi-10x-x-109">&#x03C3;</span><sub><span 
class="cmr-8">0</span></sub> is the largest
singular value. This is enabled in the code by specifying a value to the paramter
<span 
class="ectt-1095">threshold</span>. To provide small values, the C/C++ notation for powers of ten is useful, e.g.,
use <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">-threshold</span><span 
class="ectt-1095">&#x00A0;1e-7</span></span></span> in the command line to enable compression with threshold
<span 
class="cmmi-10x-x-109">&#x03F5; </span><span 
class="cmr-10x-x-109">= 10</span><sup><span 
class="cmsy-8">-</span><span 
class="cmr-8">7</span></sup>. The smaller the threshold, the more accurate the simulation. However, for very
small thresholds also the calculation times as well as the memory demands increase.
Alternatively, one can fix the maximal inner dimension of the PT MPO by defining
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">compress_maxk</span></span></span>. If both are specified, <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">compress_maxk</span></span></span> acts as an upper bound for the inner
dimension.
<!--l. 384--><p class="indent" >  In principle, all that is required to add a single mode is the environment Hamiltonian <span 
class="cmmi-10x-x-109">H</span><sub><span 
class="cmmi-8">E</span></sub>
including the interaction with the system and the initial environment mode density matrix,
which can be provided in the form of two matrix valued expressions to the <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">add_single_mode</span></span></span>
parameter. For example,
<!--l. 390--><p class="noindent" >______________________________________
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-10">
te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10
&#x00A0;<br />dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0.01
&#x00A0;<br />threshold&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-7
&#x00A0;<br />
&#x00A0;<br />add_single_mode&#x00A0;&#x00A0;&#x00A0;&#x00A0;{hbar*5*&#x00A0;(Id_2&#x00A0;otimes&#x00A0;n_3)&#x00A0;+&#x00A0;hbar*1.*(|0&#x003E;&#x003C;1|_2&#x00A0;otimes&#x00A0;bdagger_3&#x00A0;+&#x00A0;|1&#x003E;&#x003C;0|_2&#x00A0;otimes&#x00A0;b_3)}&#x00A0;&#x00A0;&#x00A0;{|0&#x003E;&#x003C;0|_3}
&#x00A0;<br />
&#x00A0;<br />
&#x00A0;<br />initial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|1&#x003E;&#x003C;1|_2}
&#x00A0;<br />add_Hamiltonian&#x00A0;&#x00A0;{&#x00A0;0*Id_2&#x00A0;}
&#x00A0;<br />add_Output&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|1&#x003E;&#x003C;1|_2}
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;singlemode.out
</div>
<!--l. 404--><p class="nopar" >______________________________________
<!--l. 407--><p class="indent" >  describes the Jaynes-Cummings coupling of a two-level system with a bosonic mode which is
detuned with respect to the two-level system energy by a frequency <span 
class="cmr-10x-x-109">5 </span>in units of the
system-boson coupling (which is set to 1). This interaction conserves the number of excitations
and the dynamics will look like strongly detuned coherent Rabi oscillations. Note that
because <span 
class="cmmi-10x-x-109">H</span><sub><span 
class="cmmi-8">E</span></sub> contains the system-environment interaction, it lives on the product
Hilbert space of system and environment (system part comes first if <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">otimes</span></span></span> is used),
whereas the environment initial density matrix lives in the bare environment Hilbert
space.
<!--l. 417--><p class="indent" >  Adding more modes is as simple as adding more <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">add_single_mode</span></span></span> lines to the
parameter file. However, for many practically relevant bath more convenient sets of
command line parameters are provided, some of which we discuss in the following
subsection.
<!--l. 422--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">5.1 </span> <a 
 id="x1-60005.1"></a>Fermionic environment</h4>
<!--l. 423--><p class="noindent" >One of the predefined environments is defined by the Fermionic hopping Hamiltonian
  <table 
class="equation"><tr><td><a 
 id="x1-6001r7"></a>
  <center class="math-display" >
<img 
src="documentation8x.png" alt="HkE =  &#x210F;g(c&#8224;kcS + c&#8224;Sck)+ &#x210F; &#x03C9;kc&#8224;kck
" class="math-display" ></center></td><td class="equation-label">(7)</td></tr></table>
<!--l. 428--><p class="nopar" >
Here, the system is a Fermionic state that may be occupied <span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">1</span><span 
class="cmsy-10x-x-109">&#x27E9; </span><span 
class="cmr-10x-x-109">= </span><span 
class="cmmi-10x-x-109">c</span><sub><span 
class="cmmi-8">S</span></sub><sup><span 
class="cmsy-8">&#8224;</span></sup><span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">0</span><span 
class="cmsy-10x-x-109">&#x27E9; </span>or not <span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">0</span><span 
class="cmsy-10x-x-109">&#x27E9;</span>. The
occupation is created by <span 
class="cmmi-10x-x-109">c</span><sub><span 
class="cmmi-8">S</span></sub><sup><span 
class="cmsy-8">&#8224;</span></sup> or destroyed by <span 
class="cmmi-10x-x-109">c</span><sub><span 
class="cmmi-8">S</span></sub>. The environment consists of several Fermionic
states, whose occupations are created and destroyed by <span 
class="cmmi-10x-x-109">c</span><sub><span 
class="cmmi-8">k</span></sub><sup><span 
class="cmsy-8">&#8224;</span></sup> and <span 
class="cmmi-10x-x-109">c</span><sub><span 
class="cmmi-8">k</span></sub>, respectively. In the limit
<span 
class="cmmi-10x-x-109">N</span><sub><span 
class="cmmi-8">E</span></sub> <span 
class="cmsy-10x-x-109">&#x2192;&#x221E;</span>, the environment consists of a continuum of state, which can be used to model the
electronic states in metallic contacts in proximity to a molecule or a quantum dot. Consider the
driver file:
<!--l. 439--><p class="noindent" >______________________________________
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-11">
te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;5
&#x00A0;<br />dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-2
&#x00A0;<br />threshold&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-7
&#x00A0;<br />
&#x00A0;<br />Fermion_N_modes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;<br />Fermion_g&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;<br />Fermion_omega_min&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />Fermion_omega_max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />Fermion_EFermi&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e4
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Fermion_N2.out
</div>
<!--l. 452--><p class="nopar" >______________________________________
<!--l. 455--><p class="indent" >  <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_*</span></span></span> indicates that what comes after is a parameter for the Fermionic environment
specified by the above Hamiltonian. <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_N_modes</span></span></span> tells the code to use 2 Fermionic states
as environment. The coupling strength is determined by <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_g</span></span></span> and the energies are
equidistantly sampled from <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_omega_min</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_omega_max</span></span></span> (in inverse
picoseconds; there also exist the alternative <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_E_min</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_E_max</span></span></span> to specify the
band width in units of meV). Here, both limits are set to zero, so that both environment modes
are resonant to the TLS transition. By setting <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_EFermi</span><span 
class="ectt-1095">&#x00A0;1e4</span></span></span> the Fermi level is set to
such a high value that all environment states are initially occupied. There is also the parameter
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_temperature</span></span></span> to specify the temperature (in units of Kelvin) of the Fermi
distribution. If not specified, the global <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">temperature</span></span></span> parameter will be used, whose default is 0
K.
<!--l. 472--><p class="indent" >  Here, the initial state of the system is empty. Therefore, electrons will start to move from the
Fermionic environment to the system. The dynamics is show below and it is discussed in the
ACE article.
<!--l. 476--><p class="indent" >  <img 
src="figs/plot_hopping_N2.png" alt="PIC"  
width="569" height="275" >
<!--l. 479--><p class="indent" >  Typically, the environments of open quantum system are assumed to form a continuum. In
ACE, we simply discretize the continuum. For the case of metallic leads, it turns out that using
<span 
class="cmmi-10x-x-109">N</span><sub><span 
class="cmmi-8">E</span></sub> <span 
class="cmr-10x-x-109">= 10 </span>modes is already not too bad. Consider the driver file <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion.param</span></span></span>:
<!--l. 485--><p class="noindent" >______________________________________
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-12">
te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.5
&#x00A0;<br />dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-2
&#x00A0;<br />threshold&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-7
&#x00A0;<br />
&#x00A0;<br />Fermion_N_modes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10
&#x00A0;<br />Fermion_rate&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;<br />Fermion_omega_min&#x00A0;&#x00A0;&#x00A0;&#x00A0;-5
&#x00A0;<br />Fermion_omega_max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;5
&#x00A0;<br />Fermion_EFermi&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e4
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Fermion_N10.out
</div>
<!--l. 498--><p class="nopar" >______________________________________
<!--l. 501--><p class="indent" >  Here, instead of <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_g</span></span></span>, we use <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_rate</span></span></span> to specify the rate that we would expect
in the Markov limit. Then, the coupling constant is calculated internally by solving the Fermi&#8217;s
golden rule expression for <span 
class="cmmi-10x-x-109">g</span>. The respective dynamics is compared with the Markovian result
<span 
class="cmr-10x-x-109">1 </span><span 
class="cmsy-10x-x-109">-</span> <span 
class="cmr-10x-x-109">exp</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmsy-10x-x-109">-</span><span 
class="cmmi-10x-x-109">x</span><span 
class="cmr-10x-x-109">) </span>in the following plot:
<!--l. 507--><p class="indent" >  <img 
src="figs/plot_hopping_N10.png" alt="PIC"  
width="569" height="272" >
<!--l. 509--><p class="indent" >  Increasing <span 
class="cmmi-10x-x-109">N</span><sub><span 
class="cmmi-8">E</span></sub> even further to about 100 while keeping the same density of states (i.e.
increasing the band width simultaneously) will produce a behaviour very close to the
Markovian results.
<!--l. 514--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">5.2 </span> <a 
 id="x1-70005.2"></a>Bosonic environments</h4>
<!--l. 515--><p class="noindent" >The class of <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_*</span></span></span> environments covers environment Hamiltonians of the form
  <table 
class="equation"><tr><td><a 
 id="x1-7001r8"></a>
  <center class="math-display" >
<img 
src="documentation9x.png" alt="      &#x2211;
HE  =    [&#x210F;&#x03C9;ka&#8224;kak + &#x210F;gk(a&#8224;kO&#x02C6;sys + akO&#x02C6;&#8224;sys)].
       k
" class="math-display" ></center></td><td class="equation-label">(8)</td></tr></table>
                                                                                
                                                                                
<!--l. 522--><p class="nopar" >
In the case <span 
class="cmmi-10x-x-109">Ô</span><sub><span 
class="cmmi-8">sys</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">1 </span><span 
class="cmmi-10x-x-109">&#x003E;&#x003C; </span><span 
class="cmr-10x-x-109">1</span><span 
class="cmsy-10x-x-109">|</span><sub><span 
class="cmr-8">2</span></sub>, this leads to the independent boson model, which is often used
to model the effects of vibrational baths (phonons). If instead <span 
class="cmmi-10x-x-109">Ô</span><sub><span 
class="cmmi-8">sys</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">0 </span><span 
class="cmmi-10x-x-109">&#x003E;&#x003C; </span><span 
class="cmr-10x-x-109">1</span><span 
class="cmsy-10x-x-109">|</span><sub><span 
class="cmr-8">2</span></sub> is
used, the Hamiltonian describes Jaynes-Cummings interactions, e.g., a quantum
emitter coupled to photon modes. This name of the parameter for this operator is
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_SysOp</span></span></span>.
<!--l. 530--><p class="indent" >  The command line arguments are similar to that for the Fermionic case, only that
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_*</span></span></span> is replaced by <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_*</span></span></span>. The main differences to the Fermionic case are that
initial thermal states now follow Bose statistics and that the number of excitations
per mode is, in principle, unbounded. Here, we truncate the Boson Hilbert space
per mode and only account for the <span 
class="cmmi-10x-x-109">M </span>lowest states, i.e. <span 
class="cmmi-10x-x-109">M </span><span 
class="cmsy-10x-x-109">- </span><span 
class="cmr-10x-x-109">1 </span>excitations. This
information if provided to the code by the parameter <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_M</span></span></span>, whose default value is
<span 
class="cmmi-10x-x-109">M </span><span 
class="cmr-10x-x-109">= 2</span>.
<!--l. 539--><p class="indent" >  As a first example, consider the radiative decay of an initially excited two-level quantum
emitter. The corresponding parameter file <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">radiative_decay.param</span></span></span> is
<!--l. 544--><p class="noindent" >______________________________________
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-13">
te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.5
&#x00A0;<br />dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-1
&#x00A0;<br />threshold&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-5
&#x00A0;<br />
&#x00A0;<br />Boson_N_modes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20
&#x00A0;<br />Boson_SysOp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|0&#x003E;&#x003C;1|_2}
&#x00A0;<br />Boson_rate&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;<br />Boson_omega_min&#x00A0;&#x00A0;&#x00A0;&#x00A0;-10
&#x00A0;<br />Boson_omega_max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10
&#x00A0;<br />Boson_temperature&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />
&#x00A0;<br />initial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|1&#x003E;&#x003C;1|_2}
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;radiative_decay.out
</div>
<!--l. 560--><p class="nopar" >______________________________________
<!--l. 563--><p class="indent" >  The resulting dynamics resembles the Markovian result with excited state occupations
<span 
class="cmsy-10x-x-109">&#x27E8;</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">1</span><span 
class="cmsy-10x-x-109">&#x27E9;&#x27E8;</span><span 
class="cmr-10x-x-109">1</span><span 
class="cmsy-10x-x-109">|</span><span 
class="cmr-10x-x-109">)</span><span 
class="cmsy-10x-x-109">&#x27E9; </span><span 
class="cmr-10x-x-109">=</span> <span 
class="cmr-10x-x-109">exp</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmsy-10x-x-109">-</span><span 
class="cmmi-10x-x-109">t</span><span 
class="cmr-10x-x-109">)</span>. (Again, an environment with larger band width would lead to a more
Markovian behaviour, but has to be discretized with more modes and therefore takes longer to
calculate.).
<!--l. 570--><p class="indent" >  One caveat for calculations at finite temperatures: The Jaynes-Cummings Hamiltonian acts
in the rotating frame. This means that the physical energy of a Bosonic excitation is
actually <span 
class="cmr-10x-x-109">(</span><span 
class="msbm-10x-x-109">&#x210F;</span><span 
class="cmmi-10x-x-109">&#x03C9; </span><span 
class="cmr-10x-x-109">+ </span><span 
class="cmmi-10x-x-109">E</span><sub><span 
class="cmmi-8">shift</span></sub><span 
class="cmr-10x-x-109">)</span><span 
class="cmmi-10x-x-109">n</span>, where <span 
class="cmmi-10x-x-109">E</span><sub><span 
class="cmmi-8">shift</span></sub> is the energy shift corresponding to the frequency
of the rotating frame. Hence, negative values of <span 
class="cmmi-10x-x-109">&#x03C9; </span>are physically allowed if their
modulus is smaller than <span 
class="cmmi-10x-x-109">E</span><sub><span 
class="cmmi-8">shift</span></sub>. For initial thermal states, this value can be provided by
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_E_shift_init</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_omega_shift_init</span></span></span>. The latter is internally multiplied by
<span 
class="msbm-10x-x-109">&#x210F;</span>.
<!--l. 580--><p class="indent" >  For structured baths where every environment mode is coupled to the system with a
different strength, i.e., <span 
class="cmmi-10x-x-109">g</span><sub><span 
class="cmmi-8">k</span></sub> is not constant as a function of <span 
class="cmmi-10x-x-109">k</span>, there are different ways to pass the
values for <span 
class="cmmi-10x-x-109">E</span><sub><span 
class="cmmi-8">k</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="msbm-10x-x-109">&#x210F;</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><sub><span 
class="cmmi-8">k</span></sub> and <span 
class="cmmi-10x-x-109">g</span><sub><span 
class="cmmi-8">k</span></sub> to the code. One way is to compile a file with two columns, the
first listing the values of <span 
class="cmmi-10x-x-109">E</span><sub><span 
class="cmmi-8">k</span></sub> (or <span 
class="cmmi-10x-x-109">&#x03C9;</span><sub><span 
class="cmmi-8">k</span></sub>) and the second listing the corresponding values of
<span 
class="cmmi-10x-x-109">g</span><sub><span 
class="cmmi-8">k</span></sub>. Please make sure the number of lines matches <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_N_modes</span></span></span>. The name of
this file can be passed to the code by the argument <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_E_g_from_table</span></span></span> (or
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_omega_g_from_table</span></span></span>). For example, if we create the file &#8220;N20.tab&#8221; with the 20
lines
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-14">
-9.5&#x00A0;&#x00A0;&#x00A0;{1/sqrt(2*pi)}
&#x00A0;<br />-8.5&#x00A0;&#x00A0;&#x00A0;{1/sqrt(2*pi)}
&#x00A0;<br />-7.5&#x00A0;&#x00A0;&#x00A0;{1/sqrt(2*pi)}
&#x00A0;<br />-6.5&#x00A0;&#x00A0;&#x00A0;{1/sqrt(2*pi)}
&#x00A0;<br />...
&#x00A0;<br />&#x00A0;9.5&#x00A0;&#x00A0;&#x00A0;{1/sqrt(2*pi)}
</div>
<!--l. 597--><p class="nopar" > the following driver file
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-15">
te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.5
&#x00A0;<br />dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-1
&#x00A0;<br />threshold&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-5
&#x00A0;<br />
&#x00A0;<br />Boson_N_modes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20
&#x00A0;<br />Boson_SysOp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|0&#x003E;&#x003C;1|_2}
&#x00A0;<br />Boson_omega_g_from_table&#x00A0;&#x00A0;&#x00A0;N20.tab
&#x00A0;<br />Boson_temperature&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />
&#x00A0;<br />initial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|1&#x003E;&#x003C;1|_2}
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;radiative_decay_tab.out
</div>
<!--l. 612--><p class="nopar" > exactly reproduces the results in &#8220;radiative_decay.out&#8221;.
<!--l. 615--><p class="indent" >  Another way, which is highly recommended, is to use instead a spectral density defined
by
  <table 
class="equation"><tr><td><a 
 id="x1-7002r9"></a>
  <center class="math-display" >
<img 
src="documentation10x.png" alt="       &#x2211;    2
J(&#x03C9; ) =    gk&#x03B4;(&#x03C9; - &#x03C9;k)
        k
" class="math-display" ></center></td><td class="equation-label">(9)</td></tr></table>
<!--l. 619--><p class="nopar" >
which is assumed to be a continuous function of <span 
class="cmmi-10x-x-109">&#x03C9; </span>in the limit of infinitely fine discretization.
The spectral density has a more intuitive interpretation. For example, in the case of
radiative decay, the radiative decay rate in the Markov limit of a system driven with
frequency <span 
class="cmmi-10x-x-109">&#x03C9; </span>is <span 
class="cmr-10x-x-109">2</span><span 
class="cmmi-10x-x-109">&#x03C0;J</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><span 
class="cmr-10x-x-109">)</span>, a finding which we reproduce numerically next. In contrast, to
reproduce a given rate, the values of <span 
class="cmmi-10x-x-109">g</span><sub><span 
class="cmmi-8">k</span></sub> have to be modified when the discretization
changes.
<!--l. 629--><p class="indent" >  A spectral density can be provided to the ACE code in the form of a file that
contains two columns corresponding to a set of sample points <span 
class="cmmi-10x-x-109">&#x03C9;</span><sub><span 
class="cmmi-8">i</span></sub> and <span 
class="cmmi-10x-x-109">J</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><sub><span 
class="cmmi-8">i</span></sub><span 
class="cmr-10x-x-109">)</span>. The sample
points <span 
class="cmmi-10x-x-109">&#x03C9;</span><sub><span 
class="cmmi-8">i</span></sub> are not related to the discretization used for defining the set of environment
modes. Instead, the frequency domain from <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_omega_min</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_omega_max</span></span></span> is
discretized into <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_N_modes</span></span></span> intervals and the corresponding values for <span 
class="cmmi-10x-x-109">g</span><sub><span 
class="cmmi-8">k</span></sub> are
                                                                                
                                                                                
obtained by linearly interpolating between the closest sample points to <span 
class="cmmi-10x-x-109">&#x03C9;</span><sub><span 
class="cmmi-8">k</span></sub> in the
spectral density file. This way, the spectral density file has to be generated only
once and can be reused for calculations with different mode discretizations. In the
following example, we reproduce the above result for radiative decay, now using a
flat spectral density. To this end, generate the file <span 
class="ectt-1095">Jflat.J </span>with the following two
lines
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-16">
-100.&#x00A0;1.
&#x00A0;<br />&#x00A0;100.&#x00A0;1.
</div>
<!--l. 644--><p class="nopar" > Therefore, all interpolated values of <span 
class="cmmi-10x-x-109">J</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><span 
class="cmr-10x-x-109">) </span>will be 1. We then use the parameter
file
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-17">
te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2.5
&#x00A0;<br />dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-1
&#x00A0;<br />threshold&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-5
&#x00A0;<br />
&#x00A0;<br />Boson_N_modes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20
&#x00A0;<br />Boson_SysOp&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|0&#x003E;&#x003C;1|_2}
&#x00A0;<br />Boson_J_from_file&#x00A0;&#x00A0;&#x00A0;&#x00A0;Jflat.J
&#x00A0;<br />Boson_J_scale&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{1/(2*pi)}
&#x00A0;<br />Boson_omega_min&#x00A0;&#x00A0;&#x00A0;&#x00A0;-10
&#x00A0;<br />Boson_omega_max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;10
&#x00A0;<br />Boson_temperature&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />
&#x00A0;<br />initial&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{|1&#x003E;&#x003C;1|_2}
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Jflat.out
</div>
<!--l. 663--><p class="nopar" >
<!--l. 665--><p class="indent" >  The parameter <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_scale</span></span></span> rescales the spectral density by a global factor for all sample
points, in this case <span 
class="cmr-10x-x-109">1</span><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">(2</span><span 
class="cmmi-10x-x-109">&#x03C0;</span><span 
class="cmr-10x-x-109">)</span>, so the expected Markovian rate will be <span 
class="cmr-10x-x-109">2</span><span 
class="cmmi-10x-x-109">&#x03C0;J</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><span 
class="cmr-10x-x-109">) = 2</span><span 
class="cmmi-10x-x-109">&#x03C0;</span><span 
class="cmr-10x-x-109">(1</span><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">(2</span><span 
class="cmmi-10x-x-109">&#x03C0;</span><span 
class="cmr-10x-x-109">)) = 1</span>.
Please check that this approach reproduces exactly the result for radiative decay discussed
above.
<!--l. 672--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">5.3 </span> <a 
 id="x1-80005.3"></a>Predefined spectral densities</h4>
<!--l. 674--><p class="noindent" >Some commonly used spectral densities are predefined and can be enabled by the command
line argument <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_type</span></span></span>. For example, one often uses spectral densities of the
form
  <table 
class="equation"><tr><td><a 
 id="x1-8001r10"></a>
  <center class="math-display" >
<img 
src="documentation11x.png" alt="         s
J(&#x03C9;) = &#x03B1;&#x03C9; H (&#x03C9;),
" class="math-display" ></center></td><td class="equation-label">(10)</td></tr></table>
                                                                                
                                                                                
<!--l. 679--><p class="nopar" >
which is characterized by the exponent <span 
class="cmmi-10x-x-109">s </span>distinguishing ohmic <span 
class="cmmi-10x-x-109">s </span><span 
class="cmr-10x-x-109">= 1 </span>from sub- (<span 
class="cmmi-10x-x-109">s &#x003C; </span><span 
class="cmr-10x-x-109">1</span>) and
superohmic (<span 
class="cmmi-10x-x-109">s &#x003E; </span><span 
class="cmr-10x-x-109">1</span>) spectral densities. <span 
class="cmmi-10x-x-109">&#x03B1; </span>sets the strength of the system-bath coupling and
<span 
class="cmmi-10x-x-109">H</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><span 
class="cmr-10x-x-109">) </span>is a cut-off function used to make the large-<span 
class="cmmi-10x-x-109">&#x03C9; </span>limit well defined. This type of spectral
density is activated by setting <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_type</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">ohmic</span></span></span>. <span 
class="cmmi-10x-x-109">&#x03B1; </span>and <span 
class="cmmi-10x-x-109">s </span>can be set via <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_alpha</span></span></span>
and <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_s</span></span></span>, respectively. The finite energy range defined by <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_omega_min</span></span></span> and
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_omega_max</span></span></span> already leads to a natural cutoff, but one can also use, e.g., an exponential
cutoff <span 
class="cmmi-10x-x-109">H</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><span 
class="cmr-10x-x-109">) = </span><span 
class="cmmi-10x-x-109">exp</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmsy-10x-x-109">-</span><span 
class="cmmi-10x-x-109">&#x03C9;&#x2215;&#x03C9;</span><sub><span 
class="cmmi-8">c</span></sub><span 
class="cmr-10x-x-109">) </span>by setting <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_cutoff</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">exp</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_omega_c</span></span></span> to
<span 
class="cmmi-10x-x-109">&#x03C9;</span><sub><span 
class="cmmi-8">c</span></sub>.
<!--l. 693--><p class="indent" >  Keep in mind that the generated spectral density can be printed by providing a file name to
the parameter <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_print</span></span></span>, which can be useful for debugging.
<!--l. 699--><p class="indent" >  The independent boson model, i.e, a TLS diagonally and linearly coupled to a continuum of
harmonic oscillators, is also a good model for the coupling between electronic states in a
quantum dot (QD) and longitudinal acoustic phonons. The corresponding Hamiltonian
is
  <table 
class="equation"><tr><td><a 
 id="x1-8002r11"></a>
  <center class="math-display" >
<img 
src="documentation12x.png" alt="      &#x2211;       &#8224;          &#8224;
HE  =    [&#x210F;&#x03C9;qbqbq + &#x210F;&#x03B3;q(bq + bq)|X &#x27E9;&#x27E8;X|],
       q
" class="math-display" ></center></td><td class="equation-label">(11)</td></tr></table>
<!--l. 709--><p class="nopar" >
<!--l. 711--><p class="indent" >  where <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmbx-8">q</span></sub><sup><span 
class="cmsy-8">&#8224;</span></sup> and <span 
class="cmmi-10x-x-109">b</span><sub><span 
class="cmbx-8">q</span></sub> are creation and annihilation operators for phonons with wave vector
<span 
class="cmbx-10x-x-109">q</span>.
<!--l. 714--><p class="indent" >  Due to the ordered structure of solid state crystals, electron-phonon interactions are well
understood and can be derived from microscopic considerations. It turns out that the dominant
deformation potential coupling to longitudinal acoustic phonons is superohmic with exponent
<span 
class="cmmi-10x-x-109">s </span><span 
class="cmr-10x-x-109">= 3</span>. For a typical GaAs-based semiconductor quantum dot, a set of parameters that enter
the spectral density has been worked out by Krummheuer <span 
class="ecti-1095">et al. </span>in [Phys. Rev. B 71, 235329
(2005)]. To use them, simply set <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_J_type</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">QDPhonon</span></span></span>. Try the following parameter file
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">QDPhonon_ACE.param</span></span></span>:
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-18">
te&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20
&#x00A0;<br />dt&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-1
&#x00A0;<br />Nintermediate&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;20
&#x00A0;<br />
&#x00A0;<br />threshold&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;5e-8
&#x00A0;<br />dict_zero&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1e-12
&#x00A0;<br />
&#x00A0;<br />add_Hamiltonian&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{-1.5*|1&#x003E;&#x003C;1|_2}
&#x00A0;<br />add_Pulse&#x00A0;Gauss&#x00A0;&#x00A0;7&#x00A0;5&#x00A0;3&#x00A0;0&#x00A0;&#x00A0;&#x00A0;{|1&#x003E;&#x003C;0|_2}
&#x00A0;<br />
&#x00A0;<br />Boson_N_modes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;100
&#x00A0;<br />Boson_M&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3
&#x00A0;<br />Boson_E_max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;5
&#x00A0;<br />Boson_J_type&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;QDPhonon
&#x00A0;<br />Boson_subtract_polaron_shift&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;true
&#x00A0;<br />temperature&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4
&#x00A0;<br />
&#x00A0;<br />outfile&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;QDPhonon_ACE.out
</div>
<!--l. 744--><p class="nopar" >
<!--l. 746--><p class="indent" >  Two parameters in this file have not been discussed so far, <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">dict_zero</span></span></span> and
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_subtract_polaron_shift</span></span></span>. The former enables a trick to increase efficiency
based on group decomposition as discussed in the supplementary material of the
ACE article on the example of superradiance, which is also related to [Phys. Rev. B
96, 201201(R) (2017)] describing an analogous idea for the iQUAPI method: For
certain types of couplings, MPO matrices <span 
class="cmsy-10x-x-109"><img 
src="cmsy10-51.png" alt="Q" class="10-109x-x-51" /></span><sub><span 
class="cmmi-8">d</span><sub><span 
class="cmmi-6">l</span></sub><span 
class="cmmi-8">d</span><sub><span 
class="cmmi-6">l</span><span 
class="cmsy-6">-</span><span 
class="cmr-6">1</span></sub></sub><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">&#x03B1;</span><sub><span 
class="cmmi-6">l</span></sub><span 
class="cmmi-8">,</span><img 
src="documentation13x.png" alt="&#x02DC;&#x03B1;"  class="tilde" ><sub><span 
class="cmmi-6">l</span></sub><span 
class="cmr-8">)</span></sup> are identical for different
combinations of <span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">l</span></sub><span 
class="cmmi-10x-x-109">,</span><img 
src="documentation14x.png" alt="&#x02DC;&#x03B1;"  class="tilde" ><sub><span 
class="cmmi-8">l</span></sub><span 
class="cmr-10x-x-109">)</span>. In this case, only one representation has to be stored and
calculated, which reduces the numerical demands. In the above example with diagonal
coupling (<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_SysOp</span></span></span> has the default value of <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">|1&#x003E;&#x003C;1|_2</span></span></span>), the environment does
not induce system transitions, so <span 
class="cmsy-10x-x-109"><img 
src="cmsy10-51.png" alt="Q" class="10-109x-x-51" /></span><sub><span 
class="cmmi-8">d</span><sub><span 
class="cmmi-6">l</span></sub><span 
class="cmmi-8">d</span><sub><span 
class="cmmi-6">l</span><span 
class="cmsy-6">-</span><span 
class="cmr-6">1</span></sub></sub><sup><span 
class="cmr-8">(</span><span 
class="cmmi-8">&#x03B1;</span><sub><span 
class="cmmi-6">l</span></sub><span 
class="cmmi-8">,</span><img 
src="documentation15x.png" alt="&#x02DC;&#x03B1;"  class="tilde" ><sub><span 
class="cmmi-6">l</span></sub><span 
class="cmr-8">)</span></sup> <span 
class="cmr-10x-x-109">= 0 </span>for <span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">l</span></sub><span 
class="cmmi-10x-x-109">&#x2260;</span><img 
src="documentation16x.png" alt="&#x03B1;&#x02DC;"  class="tilde" ><sub><span 
class="cmmi-8">l</span></sub>. These don&#8217;t have to
be stored, reducing the numerical demands by at least a factor of 4 (<span 
class="cmr-10x-x-109">2</span><sup><span 
class="cmr-8">2</span></sup> instead of
<span 
class="cmr-10x-x-109">2</span><sup><span 
class="cmr-8">4</span></sup> combinations of <span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03B1;</span><sub><span 
class="cmmi-8">l</span></sub><span 
class="cmmi-10x-x-109">,</span><img 
src="documentation17x.png" alt="&#x02DC;&#x03B1;"  class="tilde" ><sub><span 
class="cmmi-8">l</span></sub><span 
class="cmr-10x-x-109">)</span>). Which matrices are zero and which are identical with
matrices for other combinations of system indices can be computed automatically
from the microscopic Hamiltonian. The parameter <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">dict_zero</span></span></span> tells the code what
can be considered as practically zero or practically identical for this purpose. If a
positive value is given, automatic detection of groups with identical couplings is
enabled.
<!--l. 771--><p class="indent" >  Setting <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_subtract_polaron_shift</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">true</span></span></span> tells the code to subtract polaron shift
from the system energy levels: For the independent boson model, it is well known that the
interaction with the bath renormalizes the energies of the system by the polaron shift
<span 
class="cmr-10x-x-109">&#x0394;</span><span 
class="cmmi-10x-x-109">E</span><sub><span 
class="cmmi-8">p</span></sub> <span 
class="cmr-10x-x-109">= </span><span 
class="cmsy-10x-x-109">-</span><span 
class="cmex-10x-x-109">&#x2211;</span>
  <sub><span 
class="cmbx-8">q</span></sub><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03B3;</span><sub><span 
class="cmbx-8">q</span></sub><sup><span 
class="cmr-8">2</span></sup><span 
class="cmr-10x-x-109">)</span><span 
class="cmmi-10x-x-109">&#x2215;</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><sub><span 
class="cmbx-8">q</span></sub><span 
class="cmr-10x-x-109">) = </span><span 
class="cmsy-10x-x-109">-</span><span 
class="cmex-10x-x-109">&#x222B;</span>
 <sub><span 
class="cmr-8">0</span></sub><sup><span 
class="cmsy-8">&#x221E;</span></sup><span 
class="cmmi-10x-x-109">d&#x03C9;</span><span style="margin-left:0.3em" class="thinspace"></span><span 
class="cmmi-10x-x-109">J</span><span 
class="cmr-10x-x-109">(</span><span 
class="cmmi-10x-x-109">&#x03C9;</span><span 
class="cmr-10x-x-109">)</span><span 
class="cmmi-10x-x-109">&#x2215;d&#x03C9;</span>. As this shift is present irrespective
                                                                                
                                                                                
of the state of the system or the environment, experimental determination of the
energy levels of the TLS usually reveals the polaron shifted values. It is therefore
convenient to subtract the polaron shift, redefine the energy levels, and avoid dealing with
renormalization effects explicitly when comparing calculations with and without
phonons.
<!--l. 786--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">5.4 </span> <a 
 id="x1-90005.4"></a>Related computational methods</h4>
<!--l. 787--><p class="noindent" >Finally, as an alternative to ACE, the process tensor for Gaussian baths can be calculated
using expressions where the bath is already integrated out [cf. Jørgensen and Pollock Phys.
Rev. Lett. 123, 240602 (2019)]. This method is usually much more efficient and does not
require discretization or truncation of the phonon Hilbert spaces (Recall: The advantage of
ACE is its generality, while the latter method only works for Gaussian baths.) To use this
method instead for phonon simulations with our standard QD phonon spectral density, one
only needs to set <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">use_Gaussian</span></span></span> to <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">true</span></span></span>. For example, we can re-use the parameter file from
the last example and run:
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-19">
&#x003E;&#x00A0;ACE&#x00A0;QDPhonon_ACE.param&#x00A0;-use_Gaussian&#x00A0;true&#x00A0;-outfile&#x00A0;QDPhonon_Gaussian.out
</div>
<!--l. 801--><p class="nopar" >
<!--l. 803--><p class="indent" >  With the ACE code, we also provide binaries for the iterative methods iQUAPI and
TEMPO. If they are compiled, you can also try
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-20">
&#x003E;&#x00A0;TEMPO&#x00A0;QDPhonon_ACE.param&#x00A0;-outfile&#x00A0;QDPhonon_TEMPO.out
</div>
<!--l. 807--><p class="nopar" > or
                                                                                
                                                                                
  <div class="verbatim" id="verbatim-21">
&#x003E;&#x00A0;iQUAPI&#x00A0;QDPhonon_ACE.param&#x00A0;-n_max&#x00A0;12&#x00A0;-dt&#x00A0;0.2&#x00A0;-outfile&#x00A0;QDPhonon_iQUAPI.out
</div>
<!--l. 811--><p class="nopar" > Note that iQUAPI performs no tensor network compression but instead works by memory
truncation, where only a fixed maximal number <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">n_max</span></span></span> of past time steps are accounted for.
Because the memory demands scale exponentially with <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">n_max</span></span></span>, only relatively small values of
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">n_max</span></span></span> can be used in practice. To cover the memory time of the environment the time step
width <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">dt</span></span></span> should be choosen as large as possible.
<!--l. 820--><p class="noindent" >
  <h4 class="subsectionHead"><span class="titlemark">5.5 </span> <a 
 id="x1-100005.5"></a>Reading, writing, and combining process tensors</h4>
<!--l. 822--><p class="noindent" >A PT generated by the ACE cod ecan be written into a binary file with a name specified by
the <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">write_PT</span></span></span> parameter. Such a PT can then be read for another simulation using the
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">read_PT</span></span></span>. Furthermore, multiple PTs can be loaded and used for the propagation by the
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">multi_PT</span></span></span> argument. The difference between the use of <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">read_PT</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">multi_PT</span></span></span> is that when
new baths are specified, e.g., by setting <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Boson_N_modes</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">Fermion_N_modes</span></span></span> to nonzero values
or using an <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">add_single_mode</span></span></span> line, these new baths will be incorporated into a PT specified by
<span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">read_PT</span></span></span>, while the PTs defined by <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">multi_PT</span></span></span> are only loaded for the propagation of a concrete
simulation.
<!--l. 837--><p class="noindent" >
  <h3 class="sectionHead"><span class="titlemark">6 </span> <a 
 id="x1-110006"></a>Concluding remarks</h3>
<!--l. 838--><p class="noindent" >Further developments of ACE, the method as well as the code, are ongoing projects. Some
implemented features are not described in the documentation yet, but will be added in the
future.
   
</body></html> 

                                                                                


